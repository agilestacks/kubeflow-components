---
version: 1
kind: component
meta:
  name: nginx
  source:
      dir: components/nginxing

requires:
- helm

provides:
- nginx

parameters:
- name: projectId
  env: PROJECT
- name: component.gke.name
  env: NAME  
- name: component.gke.zone
  empty: allow
  env: ZONE    

- name: hub.componentName
  env: COMPONENT_NAME  
- name: dns.domain
  env: DOMAIN_NAME
- name: component.tls.kind
  empty: allow
  env: TLS_KIND
- name: component.ingress
  parameters:
  - name: namespace
    value: ingress
    env: NAMESPACE
- name: component.nginxing
  parameters:
  - name: replicaCount
    value: 1
  - name: kubernetes.ingressClass
    value: nginx
  - name: serviceType
    value: LoadBalancer
  - name: helm
    parameters:
    - name: chart
      value: "ingress-nginx"
      env: HELM_CHART
    - name: repo
      value: https://kubernetes.github.io/ingress-nginx
      env: HELM_REPO
    - name: version
      value: 3.12.0
      env: HELM_CHART_VERSION
outputs:
- name: component.ingress.kubernetes.ingressClass
  value: ${component.nginxing.kubernetes.ingressClass}

templates:
  files:
  - '*.template'
